{"version":3,"file":"dlx-pmpro-cloudflare-turnstile-preview-modal.js","mappings":"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","sources":["webpack://dlx-pmpro-turnstile/webpack/bootstrap","webpack://dlx-pmpro-turnstile/webpack/runtime/make namespace object","webpack://dlx-pmpro-turnstile/./src/js/preview/index.js","webpack://dlx-pmpro-turnstile/./src/scss/modal.scss"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// Set up onload event.\ndocument.addEventListener( 'DOMContentLoaded', () => {\n\t// Get form.\n\tconst form = document.querySelector( '#dlx-pmpro-turnstile-preview-form' );\n\n\t// Attach to submit button.\n\tform.addEventListener( 'submit', ( e ) => {\n\t\te.preventDefault();\n\n\t\t// Get the submit button.\n\t\tconst submitButton = form.querySelector( 'input[type=\"submit\"]' );\n\n\t\t// Disable the submit button.\n\t\tsubmitButton.setAttribute( 'disabled', 'disabled' );\n\n\t\t// Get the token.\n\t\tconst turnstileToken = document.querySelector( 'input[name=\"cf-turnstile-response\"]' );\n\t\tif ( ! turnstileToken ) {\n\t\t\tconst alert = document.createElement( 'div' );\n\t\t\talert.classList.add( 'notice' );\n\t\t\talert.classList.add( 'notice-error' );\n\t\t\talert.innerHTML = '<p>Error! We could not get the Turnstile token. Please close this modal and try with a different key.</p>';\n\t\t\tsubmitButton.insertAdjacentElement( 'afterend', alert );\n\n\t\t\t// Remove the submit button.\n\t\t\tsubmitButton.remove();\n\t\t\treturn;\n\t\t}\n\n\t\t// Append token to form action URL.\n\t\tconst url = new URL( form.action );\n\t\turl.searchParams.append( 'turnstyleToken', turnstileToken.value );\n\n\t\t// Perform fetch request.\n\t\tfetch( url.toString(), {\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json',\n\t\t\t},\n\t\t\tbody: {\n\t\t\t\taction: 'dlx_pmpro_turnstile_admin_preview_validate',\n\t\t\t\tturnStyleToken: turnstileToken.value,\n\t\t\t},\n\t\t} ).then( ( response ) => {\n\t\t\tif ( response.ok ) {\n\t\t\t\t// Let's add an inline alert after the submit button.\n\t\t\t\tconst alert = document.createElement( 'div' );\n\t\t\t\talert.classList.add( 'notice' );\n\t\t\t\talert.classList.add( 'notice-success' );\n\t\t\t\talert.innerHTML = '<p><strong>Success!</strong> Everything is working. Please close this modal and save your changes.</p>';\n\t\t\t\tsubmitButton.insertAdjacentElement( 'afterend', alert );\n\n\t\t\t\t// Remove the submit button.\n\t\t\t\tsubmitButton.remove();\n\t\t\t\treturn response.json();\n\t\t\t}\n\n\t\t\tconst alert = document.createElement( 'div' );\n\t\t\talert.classList.add( 'notice' );\n\t\t\talert.classList.add( 'notice-error' );\n\t\t\talert.innerHTML = '<p><strong>Error!</strong> Turnstile couldn\\'t verify you as human. Please close this modal and try again. If there is still an error, there may be an issue with your Turnstile keys.</p>';\n\t\t\tsubmitButton.insertAdjacentElement( 'afterend', alert );\n\n\t\t\t// Remove the submit button.\n\t\t\tsubmitButton.remove();\n\t\t}\n\t\t).catch( ( error ) => {\n\t\t\tconsole.error( error );\n\t\t} );\n\t} );\n} );\n\nwindow.onLoadDLXPMProPreviewCallback = () => {\n\tconst widgetId = turnstile.render( '#dlx-pmpro-turnstile-placeholder', {\n\t\tsitekey: dlxCF.siteKey,\n\t\tretry: 'never',\n\t\tcallback: ( token ) => {\n\t\t\t// Re-enable the submit button.\n\t\t\tconst submitButton = document.querySelector( '#dlx-pmpro-turnstile-preview-form input[type=\"submit\"]' );\n\t\t\tsubmitButton.removeAttribute( 'disabled' );\n\n\t\t\tsetTimeout( () => {\n\t\t\t\t// Reset the widget.\n\t\t\t\t// eslint-disable-next-line no-undef\n\t\t\t\tturnstile.reset( widgetId );\n\t\t\t}, 300000 ); // 300 seconds (5 mins).\n\t\t},\n\t\tsize: dlxCF.size, /* can be compact|normal. */\n\t\ttheme: dlxCF.theme, /* can be light, dark, auto */\n\t\tlanguage: dlxCF.language,\n\t\tappearance: dlxCF.appearance,\n\t} );\n};\n","// extracted by mini-css-extract-plugin\nexport {};"],"names":["document","addEventListener","form","querySelector","e","preventDefault","submitButton","setAttribute","turnstileToken","alert","createElement","classList","add","innerHTML","insertAdjacentElement","remove","url","URL","action","searchParams","append","value","fetch","toString","method","headers","body","turnStyleToken","then","response","ok","json","error","console","window","onLoadDLXPMProPreviewCallback","widgetId","turnstile","render","sitekey","dlxCF","siteKey","retry","callback","token","removeAttribute","setTimeout","reset","size","theme","language","appearance"],"sourceRoot":""}